{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "cancel-subscription-dialog",
  "type": "registry:block",
  "title": "Cancel Subscription Dialog",
  "description": "A cancel subscription dialog component",
  "dependencies": [
    "lucide-react"
  ],
  "registryDependencies": [
    "button",
    "badge",
    "dialog",
    "utils"
  ],
  "files": [
    {
      "path": "src/registry/billingsdk/cancel-subscription-dialog.tsx",
      "content": "\"use client\";\r\n\r\nimport { useState, useEffect } from \"react\"\r\nimport { Button } from \"@/components/ui/button\"\r\nimport { Badge } from \"@/components/ui/badge\"\r\nimport {\r\n    Dialog,\r\n    DialogClose,\r\n    DialogContent,\r\n    DialogTitle,\r\n    DialogTrigger,\r\n} from \"@/components/ui/dialog\"\r\nimport { type Plan } from \"@/lib/billingsdk-config\";\r\nimport { cn } from \"@/lib/utils\";\r\nimport { X, Circle } from \"lucide-react\";\r\nimport { useTheme } from \"@/contexts/theme-context\";\r\nimport { getThemeStyles } from \"@/lib/themes\";\r\n\r\nexport interface CancelSubscriptionDialogProps {\r\n    title: string;\r\n    description: string;\r\n    plan: Plan;\r\n    triggerButtonText?: string;\r\n    leftPanelImageUrl?: string;\r\n    warningTitle?: string;\r\n    warningText?: string;\r\n    keepButtonText?: string;\r\n    continueButtonText?: string;\r\n    finalTitle?: string;\r\n    finalSubtitle?: string;\r\n    finalWarningText?: string;\r\n    goBackButtonText?: string;\r\n    confirmButtonText?: string;\r\n    onCancel: (planId: string) => Promise<void> | void;\r\n    onKeepSubscription?: (planId: string) => Promise<void> | void;\r\n    onDialogClose?: () => void;\r\n    className?: string;\r\n}\r\n\r\nexport function CancelSubscriptionDialog({\r\n    title,\r\n    description,\r\n    plan,\r\n    triggerButtonText,\r\n    leftPanelImageUrl,\r\n    warningTitle,\r\n    warningText,\r\n    keepButtonText,\r\n    continueButtonText,\r\n    finalTitle,\r\n    finalSubtitle,\r\n    finalWarningText,\r\n    goBackButtonText,\r\n    confirmButtonText,\r\n    onCancel,\r\n    onKeepSubscription,\r\n    onDialogClose,\r\n    className,\r\n}: CancelSubscriptionDialogProps) {\r\n    const [showConfirmation, setShowConfirmation] = useState(false);\r\n    const [isOpen, setIsOpen] = useState(false);\r\n    const [isLoading, setIsLoading] = useState(false);\r\n    const [error, setError] = useState<string | null>(null);\r\n    const { currentTheme, previewDarkMode } = useTheme();\r\n    const themeStyles = getThemeStyles(currentTheme, previewDarkMode);\r\n\r\n    const handleContinueCancellation = () => {\r\n        setShowConfirmation(true);\r\n        setError(null);\r\n    };\r\n\r\n    const handleConfirmCancellation = async () => {\r\n        try {\r\n            setIsLoading(true);\r\n            setError(null);\r\n            await onCancel(plan.id);\r\n            handleDialogClose();\r\n        } catch (err) {\r\n            setError(err instanceof Error ? err.message : 'Failed to cancel subscription');\r\n        } finally {\r\n            setIsLoading(false);\r\n        }\r\n    };\r\n\r\n    const handleKeepSubscription = async () => {\r\n        try {\r\n            setIsLoading(true);\r\n            setError(null);\r\n            if (onKeepSubscription) {\r\n                await onKeepSubscription(plan.id);\r\n            }\r\n            handleDialogClose();\r\n        } catch (err) {\r\n            setError(err instanceof Error ? err.message : 'Failed to keep subscription');\r\n        } finally {\r\n            setIsLoading(false);\r\n        }\r\n    };\r\n\r\n    const handleDialogClose = () => {\r\n        setIsOpen(false);\r\n        setShowConfirmation(false);\r\n        setError(null);\r\n        setIsLoading(false);\r\n        onDialogClose?.();\r\n    };\r\n\r\n    const handleGoBack = () => {\r\n        setShowConfirmation(false);\r\n        setError(null);\r\n    };\r\n\r\n    // Handle keyboard shortcuts\r\n    useEffect(() => {\r\n        const handleKeyDown = (event: KeyboardEvent) => {\r\n            if (!isOpen) return;\r\n\r\n            if (event.key === 'Escape') {\r\n                event.preventDefault();\r\n                handleDialogClose();\r\n            }\r\n        };\r\n\r\n        document.addEventListener('keydown', handleKeyDown);\r\n        return () => document.removeEventListener('keydown', handleKeyDown);\r\n    }, [isOpen]);\r\n\r\n    return (\r\n        <Dialog open={isOpen} onOpenChange={(open) => {\r\n            if (open) {\r\n                setIsOpen(true);\r\n            } else {\r\n                handleDialogClose();\r\n            }\r\n        }}>\r\n            <DialogTrigger asChild>\r\n                <Button variant=\"outline\">{triggerButtonText || \"Cancel Subscription\"}</Button>\r\n            </DialogTrigger>\r\n            <DialogContent className={cn(\"sm:max-w-[1000px] flex flex-col md:flex-row p-0 overflow-hidden text-foreground w-[95%] md:w-[100%]\", leftPanelImageUrl ? \"\" : \"sm:max-w-[500px]\", className)} style={themeStyles}>\r\n                <DialogTitle className=\"sr-only\">{title}</DialogTitle>\r\n                <DialogClose\r\n                    className=\"absolute right-4 top-4 z-10 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground\"\r\n                    onClick={handleDialogClose}\r\n                >\r\n                    <X className=\"h-4 w-4\" />\r\n                    <span className=\"sr-only\">Close</span>\r\n                </DialogClose>\r\n                {leftPanelImageUrl && (\r\n                    <div className=\"w-full md:w-1/2 min-h-[500px] relative hidden md:block overflow-hidden\">\r\n                        <img src={leftPanelImageUrl} alt=\"Cancel Subscription\" className=\"absolute inset-0 w-full h-full object-cover\" />\r\n                        <div className=\"absolute inset-0 bg-gradient-to-r from-transparent via-background/30 to-background/90 dark:block hidden\"></div>\r\n                        <div className=\"absolute inset-0 bg-gradient-to-t from-background/80 via-transparent to-background/20 dark:block hidden\"></div>\r\n                    </div>\r\n                )}\r\n                <div className={cn(\"py-6 px-4 flex flex-col gap-4\", leftPanelImageUrl ? \"w-full md:w-1/2\" : \"w-full\")}>\r\n                    <div className=\"flex flex-col gap-2 text-center md:text-left\">\r\n                        <h2 className=\"md:text-2xl text-xl font-semibold\">{title}</h2>\r\n                        <p className=\"md:text-sm text-xs text-muted-foreground\">{description}</p>\r\n                        {error && (\r\n                            <div className=\"p-3 bg-destructive/10 border border-destructive/20 rounded-md\">\r\n                                <p className=\"text-sm text-destructive\">{error}</p>\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n\r\n                    {/* Plan Details */}\r\n                    {!showConfirmation && (\r\n                        <div className=\"flex flex-col gap-4 p-4 bg-muted/50 rounded-lg\">\r\n                            <div className=\"flex items-center justify-between\">\r\n                                <div className=\"flex flex-col gap-1\">\r\n                                    <span className=\"font-semibold text-lg\">{plan.title} Plan</span>\r\n                                    <span className=\"text-sm text-muted-foreground\">Current subscription</span>\r\n                                </div>\r\n                                <Badge variant=\"secondary\">\r\n                                    {\r\n                                        parseFloat(plan.monthlyPrice) >= 0 ?\r\n                                            `${plan.currency}${plan.monthlyPrice}/monthly` :\r\n                                            `${plan.monthlyPrice}/monthly`\r\n                                    }\r\n                                </Badge>\r\n                            </div>\r\n                            <div className=\"flex flex-col gap-2\">\r\n                                {plan.features.slice(0, 4).map((feature, index) => (\r\n                                    <div key={index} className=\"flex items-center gap-2\">\r\n                                        <Circle className=\"w-2 h-2 fill-primary text-primary\" />\r\n                                        <span className=\"text-sm text-muted-foreground\">{feature.name}</span>\r\n                                    </div>\r\n                                ))}\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n\r\n                    {/* Warning Section */}\r\n                    {!showConfirmation && (warningTitle || warningText) && (\r\n                        <div className=\"p-4 bg-muted/30 border border-border rounded-lg\">\r\n                            {warningTitle && (\r\n                                <h3 className=\"font-semibold text-foreground mb-2\">\r\n                                    {warningTitle}\r\n                                </h3>\r\n                            )}\r\n                            {warningText && (\r\n                                <p className=\"text-sm text-muted-foreground\">\r\n                                    {warningText}\r\n                                </p>\r\n                            )}\r\n                        </div>\r\n                    )}\r\n                    {/* Action Buttons */}\r\n                    {!showConfirmation ? (\r\n                        <div className=\"flex flex-col sm:flex-row gap-3 mt-auto\">\r\n                            <Button\r\n                                className=\"flex-1\"\r\n                                onClick={handleKeepSubscription}\r\n                                disabled={isLoading}\r\n                            >\r\n                                {isLoading ? \"Processing...\" : (keepButtonText || \"Keep My Subscription\")}\r\n                            </Button>\r\n                            <Button\r\n                                variant=\"destructive\"\r\n                                className=\"flex-1\"\r\n                                onClick={handleContinueCancellation}\r\n                                disabled={isLoading}\r\n                            >\r\n                                {continueButtonText || \"Continue Cancellation\"}\r\n                            </Button>\r\n                        </div>\r\n                    ) : (\r\n                        <div className=\"flex flex-col gap-4 mt-auto\">\r\n                            <div className=\"text-center p-4 bg-muted/50 rounded-lg\">\r\n                                <h3 className=\"font-semibold mb-2 text-foreground\">\r\n                                    {finalTitle || \"Final Confirmation\"}\r\n                                </h3>\r\n                                <p className=\"text-sm text-muted-foreground mb-2\">\r\n                                    {finalSubtitle || \"Are you sure you want to cancel your subscription?\"}\r\n                                </p>\r\n                                <p className=\"text-sm text-destructive\">\r\n                                    {finalWarningText || \"This action cannot be undone and you'll lose access to all premium features.\"}\r\n                                </p>\r\n                            </div>\r\n                            <div className=\"flex flex-col sm:flex-row gap-3\">\r\n                                <Button\r\n                                    variant=\"outline\"\r\n                                    className=\"flex-1\"\r\n                                    onClick={handleGoBack}\r\n                                    disabled={isLoading}\r\n                                >\r\n                                    {goBackButtonText || \"Go Back\"}\r\n                                </Button>\r\n                                <Button\r\n                                    variant=\"destructive\"\r\n                                    className=\"flex-1\"\r\n                                    onClick={handleConfirmCancellation}\r\n                                    disabled={isLoading}\r\n                                >\r\n                                    {isLoading ? \"Cancelling...\" : (confirmButtonText || \"Yes, Cancel Subscription\")}\r\n                                </Button>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            </DialogContent>\r\n        </Dialog>\r\n    )\r\n}\r\n",
      "type": "registry:component",
      "target": "components/billingsdk/cancel-subscription-dialog.tsx"
    },
    {
      "path": "src/registry/billingsdk/demo/cancel-subscription-dialog-demo.tsx",
      "content": "\"use client\";\r\n\r\nimport { CancelSubscriptionDialog } from \"@/components/billingsdk/cancel-subscription-dialog\";\r\nimport { plans } from \"@/lib/billingsdk-config\";\r\n\r\nexport function CancelSubscriptionDialogDemo() {\r\n    return(\r\n\r\n      <div className=\"flex flex-1 flex-col justify-center text-center p-4 mx-auto min-h-[300px]\">\r\n      <CancelSubscriptionDialog\r\n        title=\"We're sorry to see you go...\"\r\n        description={`Before you cancel, we hope you'll consider upgrading to a ${plans[1].title} plan again.`}\r\n        plan={plans[1]}\r\n        triggerButtonText=\"Cancel Subscription\"\r\n        leftPanelImageUrl=\"https://framerusercontent.com/images/GWE8vop9hubsuh3uWWn0vyuxEg.webp\"\r\n        warningTitle=\"You will lose access to your account\"\r\n        warningText=\"If you cancel your subscription, you will lose access to your account and all your data will be deleted.\"\r\n        keepButtonText={`Keep My ${plans[1].title} Plan`}\r\n        continueButtonText=\"Continue with Cancellation\"\r\n        finalTitle=\"Final Step - Confirm Cancellation\"\r\n        finalSubtitle=\"This action will immediately cancel your subscription\"\r\n        finalWarningText=\"You'll lose access to all Pro features and your data will be permanently deleted after 30 days.\"\r\n        goBackButtonText=\"Wait, Go Back\"\r\n        confirmButtonText=\"Yes, Cancel My Subscription\"\r\n        onCancel={async (planId) => {\r\n          console.log('Cancelling subscription for plan:', planId);\r\n          return new Promise((resolve) => {\r\n            setTimeout(() => {\r\n              resolve(void 0);\r\n            }, 1000);\r\n          });\r\n        }}\r\n        onKeepSubscription={async (planId) => {\r\n          console.log('Keeping subscription for plan:', planId);\r\n        }}\r\n        onDialogClose={() => {\r\n          console.log('Dialog closed');\r\n        }}\r\n        className=\"max-w-4xl\"\r\n      />\r\n    </div>\r\n    )\r\n}",
      "type": "registry:component",
      "target": "components/cancel-subscription-dialog-demo.tsx"
    },
    {
      "path": "src/registry/lib/billingsdk-config.ts",
      "content": "export interface Plan {\r\n    id: string\r\n    title: string\r\n    description: string\r\n    highlight?: boolean\r\n    type?: 'monthly' | 'yearly'\r\n    currency?: string\r\n    monthlyPrice: string\r\n    yearlyPrice: string\r\n    buttonText: string\r\n    badge?: string\r\n    features: {\r\n        name: string\r\n        icon: string\r\n        iconColor?: string\r\n    }[]\r\n}\r\n\r\nexport interface CurrentPlan {\r\n    plan: Plan\r\n    type: 'monthly' | 'yearly' | 'custom'\r\n    price?: string\r\n    nextBillingDate: string\r\n    paymentMethod: string\r\n    status: 'active' | 'inactive' | 'past_due' | 'cancelled'\r\n}\r\n\r\nexport const plans: Plan[] = [\r\n    {\r\n        id: 'starter',\r\n        title: 'Starter',\r\n        description: 'For developers testing out Liveblocks locally.',\r\n        currency: '$',\r\n        monthlyPrice: '0',\r\n        yearlyPrice: '0',\r\n        buttonText: 'Start today for free',\r\n        features: [\r\n            {\r\n                name: 'Presence',\r\n                icon: \"check\",\r\n                iconColor: 'text-green-500'\r\n            },\r\n            {\r\n                name: 'Comments',\r\n                icon: \"check\",\r\n                iconColor: 'text-orange-500'\r\n            },\r\n            {\r\n                name: 'Notifications',\r\n                icon: \"check\",\r\n                iconColor: 'text-teal-500'\r\n            },\r\n            {\r\n                name: 'Text Editor',\r\n                icon: \"check\",\r\n                iconColor: 'text-blue-500'\r\n            },\r\n            {\r\n                name: 'Sync Datastore',\r\n                icon: \"check\",\r\n                iconColor: 'text-zinc-500'\r\n            }\r\n        ],\r\n    },\r\n    {\r\n        id: 'pro',\r\n        title: 'Pro',\r\n        description: 'For companies adding collaboration in production.',\r\n        currency: '$',\r\n        monthlyPrice: '20',\r\n        yearlyPrice: '199',\r\n        buttonText: 'Sign up',\r\n        badge: 'Most popular',\r\n        highlight: true,\r\n        features: [\r\n            {\r\n                name: 'Presence',\r\n                icon: \"check\",\r\n                iconColor: 'text-green-500'\r\n            },\r\n            {\r\n                name: 'Comments',\r\n                icon: \"check\",\r\n                iconColor: 'text-orange-500'\r\n            },\r\n            {\r\n                name: 'Notifications',\r\n                icon: \"check\",\r\n                iconColor: 'text-teal-500'\r\n            },\r\n            {\r\n                name: 'Text Editor',\r\n                icon: \"check\",\r\n                iconColor: 'text-blue-500'\r\n            },\r\n            {\r\n                name: 'Sync Datastore',\r\n                icon: \"check\",\r\n                iconColor: 'text-zinc-500'\r\n            }\r\n        ],\r\n    },\r\n    {\r\n        id: 'enterprise',\r\n        title: 'Enterprise',\r\n        description: 'For organizations that need more support and compliance features.',\r\n        currency: '$',\r\n        monthlyPrice: 'Custom',\r\n        yearlyPrice: 'Custom',\r\n        buttonText: 'Contact sales',\r\n        features: [\r\n            {\r\n                name: 'Presence',\r\n                icon: \"check\",\r\n                iconColor: 'text-green-500'\r\n            },\r\n            {\r\n                name: 'Comments',\r\n                icon: \"check\",\r\n                iconColor: 'text-orange-500'\r\n            },\r\n            {\r\n                name: 'Notifications',\r\n                icon: \"check\",\r\n                iconColor: 'text-teal-500'\r\n            },\r\n            {\r\n                name: 'Text Editor',\r\n                icon: \"check\",\r\n                iconColor: 'text-blue-500'\r\n            },\r\n            {\r\n                name: 'Sync Datastore',\r\n                icon: \"check\",\r\n                iconColor: 'text-zinc-500'\r\n            }\r\n        ],\r\n    }\r\n];\r\n",
      "type": "registry:lib",
      "target": "lib/billingsdk-config.ts"
    }
  ]
}